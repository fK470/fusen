# **ブックマーク管理アプリ 要件定義書**

## **1\. はじめに**

### **1.1. 本書の目的**

本書は、「ブックマーク管理アプリ」（以下、本アプリ）の初期開発フェーズ（MVP: Minimum Viable Product）における機能要件および非機能要件を定義する。本アプリ開発は、バックエンド開発スキルの習得、拡張性の高いアプリケーション設計の学習、将来的なマイクロサービスアーキテクチャへの移行を見据えた開発経験の獲得を主目的とする。

### **1.2. ターゲットユーザー**

初期のターゲットユーザーは、開発者自身による個人利用とする。

## **2\. システム概要**

### **2.1. システム名称**

Fusen

### **2.2. システム構成**

初期はモノリシックなWebアプリケーションとして開発する。バックエンドAPIサーバーとフロントエンドSPA（Single Page Application）で構成される。今後マイクロサービス化していくことを考慮し、常に拡張性を意識して開発を進める。

## **3\. 機能要件（MVP）**

### **3.1. ブックマーク管理機能**

#### **3.1.1. ブックマーク登録**

* **機能:** 新しいブックマークをシステムに登録する。
* **入力項目:**
  * URL: 必須。
  * タイトル: 任意。未入力時は\<title\>タグの内容を抽出してタイトルとして自動設定する。抽出ロジックの詳細は別途設計する。
  * 説明メモ: 任意。
  * タグ: 任意。複数登録可能。ユーザーが自由に入力できる。
* **バリデーション:**
  * URL: http:// または https:// で始まる基本的な形式チェックを行う。
* **操作フロー:**
  * 画面上の「追加ボタン」を押下する。
  * モバイル端末では新規画面遷移、PC等の画面サイズが大きい場合はモーダルウィンドウで登録フォームを表示。

#### **3.1.2. ブックマーク一覧表示**

* **機能:** 登録されたブックマークを一覧表示する。
* **表示項目:** 各ブックマークのタイトル、説明メモの先頭部分（例: 50文字程度、詳細はUI設計時に決定）。
* **表示順:** デフォルトは登録日時が新しい順。
* **表示形式:** 初期表示は10件程度とし、画面下部へのスクロールに応じて追加のブックマークを読み込むレイジーロード方式を採用する。

#### **3.1.3. ブックマーク更新**

* **機能:** 既存のブックマーク情報を編集する。
* **更新可能項目:** URL、タイトル、説明メモ、タグ。
* **バリデーション:** URLは登録時と同様の基本的な形式チェックを行う。
* **操作フロー:**
  * 一覧表示された各ブックマークアイテムに配置された「メニューボタン」を押下し、表示される「編集ボタン」を選択する。
  * 編集画面のレイアウトは、ブックマーク登録画面と同様とする。

#### **3.1.4. ブックマーク削除**

* **機能:** 登録されたブックマークを削除する。
* **操作フロー:**
  * 一覧表示された各ブックマークアイテムに配置された「メニューボタン」を押下し、表示される「削除ボタン」を選択する。
  * 削除実行前に、確認メッセージ（例: 「本当に削除しますか？」）を表示し、ユーザーの意図しない削除を防ぐ。

### **3.2. タグ管理機能（MVPにおける基本）**

#### **3.2.1. タグ登録・関連付け**

* **機能:** ブックマーク登録時または更新時に、ブックマークに対して複数のタグを自由に入力し、関連付けることができる。
* **スコープ:** MVP段階では、特定のタグでブックマークを絞り込んだり、タグ名で検索したりする高度な機能はスコープ外とする。タグの編集・削除機能もMVPでは含めない。

## **4\. 非機能要件**

### **4.1. UI/UX**

* **デザイン:** ミニマルデザインを採用する。MVPではダークモードは非対応とする。
* **操作性:** シンプルで直感的な操作性を目指す。ユーザーの操作を妨げるような過剰なアニメーションは実装しない。
* **レスポンシブデザイン:** モバイル端末、タブレット、デスクトップPCなど、様々な画面サイズで快適に利用できるようレスポンシブデザインに対応する。
* **主要操作フロー:** 3.1節に記載の通り。

### **4.2. 性能**

* **レスポンスタイム:** 主要なユーザー操作（一覧表示、登録、更新、削除）に対するシステムの応答時間は、原則として1秒以内を目指す。

### **4.3. セキュリティ**

* **基本対策:** Spring Securityの基本的な設定（CSRF対策など）を導入し、入力値のサニタイズ処理を行うなど、XSS（クロスサイトスクリプティング）対策を含むWebアプリケーションとしての基本的なセキュリティ対策を講じる。
* **個人情報:** MVP段階では、メールアドレスのような機微な個人情報は扱わない。

### **4.4. 拡張性**

* 将来的な機能追加やマイクロサービスアーキテクチャへの移行を考慮し、疎結合でメンテナンス性の高い設計を心がける。

### **4.5. 運用・保守性**

* **ログ:** 6.5節のロギング方針に基づき、運用時の状況把握や問題発生時の原因究明に資するログを出力する。
* **設定管理:** データベース接続情報など、環境に依存する設定は外部ファイル（例: application.properties）で管理する。

## **5\. システム基盤**

### **5.1. バックエンド**

* 言語: Java 21
* フレームワーク: Spring Boot 3.4.6
* ORM: Doma
* ビルドツール: Maven
* データベース: MySQL (ローカル開発環境ではDockerを利用し、データ永続化のためのボリュームマウント設定を行う)

### **5.2. フロントエンド**

* ライブラリ/フレームワーク: React 18
* 言語: TypeScript
* パッケージマネージャー: pnpm
* ビルドツール/開発環境: Vite

### **5.3. その他共通**

* API仕様記述: OpenAPI (Swagger) を利用し、APIの仕様を明確に記述する。
* テストライブラリ: JUnit 5, Mockito, AssertJ (バックエンド); Vitest, React Testing Library (フロントエンド)
* バージョン管理: Git
* コンテナ技術: Docker (データベース環境、将来的にはAWS ECS等でのアプリケーションデプロイも視野に入れる)

## **6\. 開発体制・プロセス**

### **6.1. リポジトリ構成**

* モノレポ構成とし、バックエンドとフロントエンドのコードを1つのGitリポジトリで管理する。

### **6.2. Gitブランチ戦略**

* main: リリース可能な安定版。
* develop: 現在開発中の最新版。
* feature/xxx: 新機能開発用ブランチ。developから作成し、developへマージ。
* fix/xxx: develop上のバグ修正用ブランチ。developから作成し、developへマージ。

### **6.3. コミットメッセージ規約**

* Conventional Commits の規約に従う。

### **6.4. プルリクエスト活用**

* develop ブランチおよび main ブランチへのマージは、原則としてプルリクエストを経由する。

### **6.5. ロギング方針**

* **ログレベル:** INFO, WARN, ERROR レベルのログを標準的なライブラリ（SLF4J \+ Logback）を利用して記録する。
* **記録内容:**
  * INFO: アプリケーションの主要な処理の開始・終了、APIリクエスト受付・応答（メソッド、パス、処理時間）。
  * WARN: 予期しないが処理継続可能な状況、非推奨機能の利用など。
  * ERROR: 処理継続不可能なエラー発生時。エラーメッセージ、スタックトレース、関連リクエスト情報（機密情報はマスク）を記録。
* **エラー通知:** ERROR レベルのログが発生した場合、Webhookを利用して外部システムへ通知する。通知メッセージには、エラーの概要、発生日時、重要度などを含める。短時間に同一エラーが多発した場合の通知抑制策はMVPでは考慮しないが、将来的な課題として認識する。
* **DEBUGレベル:** 開発者がローカル環境でのデバッグ時に適宜利用する。本番環境では原則INFO以上のログレベルとする。

## **7\. API設計**

### **7.1. 基本方針**

* RESTful APIとして設計する。
* APIのバージョン情報をURLに含める (例: /api/v1/...)。

### **7.2. エンドポイント（ブックマーク関連）**

* **ブックマーク作成:** POST /api/v1/bookmarks
* **ブックマーク一覧取得:** GET /api/v1/bookmarks
  * クエリパラメータ: limit (取得件数、デフォルト10), offset (開始位置、デフォルト0) をサポートし、レイジーロードに対応する。
* **特定ブックマーク取得:** GET /api/v1/bookmarks/{id}
* **特定ブックマーク更新:** PUT /api/v1/bookmarks/{id}
* **特定ブックマーク削除:** DELETE /api/v1/bookmarks/{id}

### **7.3. リクエスト/レスポンス形式**

* データ形式: JSON
* 日時情報 (createdAt, updatedAt): ISO 8601形式の文字列で、サーバーサイドで自動的に記録し、レスポンスに含める。リクエストボディには含めない。
* エラーレスポンス形式:
  `{`
    `"errorCode": "APPLICATION_SPECIFIC_ERROR_CODE", // 例: INVALID_URL, BOOKMARK_NOT_FOUND`
    `"message": "具体的なエラーメッセージ"`
  `}`
  HTTPステータスコードも適切に設定する（例: 400, 404, 500）。

## **8\. データベース設計 (MySQL)**

本アプリケーションで使用する主要なテーブルは以下の通りです。
詳細なカラム定義、制約、リレーションシップについては、別途「テーブル定義書.md」および「ER図.md」を参照してください。

* `bookmarks`: ブックマーク情報を格納するテーブル。
* `tags`: タグ情報を格納するテーブル。
* `bookmark_tags`: ブックマークとタグの関連を管理する中間テーブル。

## **9\. 将来的な拡張機能案 (MVPのスコープ外)**

本書で定義するMVP開発の完了後、以下の機能拡張を検討する可能性がある。これらはMVPのスコープには含まれない。

* ユーザー認証機能 (Spring Security連携)
* タグによるブックマークの高度な検索・絞り込み機能
* タグ自体の編集・削除機能
* フォルダ/カテゴリ分類機能
* URLの有効性チェック機能
* ウェブページのタイトル自動取得機能（URL入力時に、より詳細なタイトルを\<title\>タグ等から取得する）
* OGP (Open Graph Protocol) 情報の取得と表示機能
* お気に入り登録機能
* ブックマークのインポート/エクスポート機能
