# Fusen アプリケーション 個人デプロイ計画

## 📋 個人向けデプロイ作業計画

### Phase 1: 事前準備（半日）
- [ ] **AWSアカウント設定**
  - [ ] AWS アカウント作成（個人アカウント）
  - [ ] AWS CLI 設定
  - [ ] リージョン選択（推奨: ap-northeast-1 東京）
  - [ ] 請求アラート設定（重要：コスト管理）

- [ ] **ドメイン準備（オプション）**
  - [ ] Vercelデフォルトドメイン使用（無料）
  - [ ] または独自ドメイン取得（年間1,000円程度）

- [ ] **開発環境調整**
  - [ ] 本番用環境変数設定
  - [ ] Docker 本番用設定最適化
  - [ ] ヘルスチェックエンドポイント追加

### Phase 2: AWS インフラ構築（1日）
- [ ] **簡単ネットワーク設定**
  - [ ] デフォルトVPC使用（設定簡略化）
  - [ ] パブリックサブネット 1つのみ
  - [ ] インターネットゲートウェイ（既存）

- [ ] **セキュリティグループ**
  - [ ] ECS用（Port 8080 from 0.0.0.0/0）※個人利用のため直接公開
  - [ ] RDS用（Port 3306 from ECS only）

- [ ] **RDS データベース（最小構成）**
  - [ ] RDS MySQL 8.0 t3.micro インスタンス
  - [ ] Single-AZ（コスト削減）
  - [ ] 自動バックアップ 7日間
  - [ ] デフォルト設定使用
  - [ ] データベース初期化

### Phase 3: コンテナ化・ECR準備（1日）
- [ ] **Docker 最適化**
  - [ ] マルチステージビルド設定
  - [ ] 本番用 Dockerfile 作成
  - [ ] .dockerignore 最適化
  - [ ] ヘルスチェック追加

- [ ] **ECR リポジトリ**
  - [ ] ECR リポジトリ作成
  - [ ] 初回イメージプッシュ
  - [ ] イメージライフサイクル設定

### Phase 3: ECS構築（1日）
- [ ] **ECS クラスター（最小構成）**
  - [ ] ECS Fargate クラスター作成
  - [ ] タスク定義作成（0.25 vCPU, 0.5GB）
  - [ ] サービス定義作成（タスク数1）
  - [ ] パブリック IP割り当て（ALB不使用）

- [ ] **環境変数管理**
  - [ ] ECSタスク定義に直接設定
  - [ ] データベース接続情報設定

### Phase 5: CI/CD構築（1-2日）
- [ ] **GitHub Actions**
  - [ ] バックエンドビルド・デプロイワークフロー
  - [ ] ECR プッシュ自動化
  - [ ] ECS サービス更新自動化
  - [ ] 環境変数・シークレット設定

- [ ] **デプロイ検証**
  - [ ] 自動テスト実行
  - [ ] ヘルスチェック確認
  - [ ] ロールバック手順確認

### Phase 6: フロントエンド Vercel デプロイ（半日）
- [ ] **Vercel 設定**
  - [ ] GitHub 連携
  - [ ] 環境変数設定（API_URL）
  - [ ] カスタムドメイン設定
  - [ ] 自動デプロイ設定

### Phase 7: 統合テスト・本番化（1日）
- [ ] **エンドツーエンドテスト**
  - [ ] フロント・バックエンド連携確認
  - [ ] 全CRUD操作テスト
  - [ ] レスポンシブデザイン確認
  - [ ] エラーハンドリング確認

- [ ] **監視・アラート設定**
  - [ ] CloudWatch メトリクス
  - [ ] ログ監視
  - [ ] アラート設定
  - [ ] ダッシュボード作成

## 💰 個人利用コスト見積もり（月額）

### Vercel（フロントエンド）
| プラン | 料金 | 用途 |
|--------|------|------|
| **Hobby** | **$0** | 個人利用、ポートフォリオ |

### AWS（バックエンド）- 最小構成
| サービス | 構成 | 月額料金（東京リージョン） |
|----------|------|------------------------|
| **ECS Fargate** | 0.25 vCPU, 0.5GB | ~$12 |
| **RDS MySQL** | db.t3.micro | ~$13 |
| **データ転送** | 3GB/月想定 | ~$0.3 |
| **CloudWatch** | 基本ログのみ | ~$2 |
| **ECR** | 0.5GB想定 | ~$0.05 |

**AWS 合計: 約 $27/月（約4,000円/月）**
**総合計: 約 $27/月（約4,000円/月）**

### 💡 コスト削減のポイント
- ALB削除でパブリックIP直接アクセス（-$16/月）
- NAT Gateway不使用（-$30/月）
- Route 53不使用、Vercelドメイン利用（-$1/月）
- Parameter Store不使用、環境変数直接設定（-$1/月）

**個人利用最適化により従来の70%削減を実現**

## 🎯 マイルストーン

| 週 | 目標 | 成果物 |
|----|------|--------|
| **Week 1** | インフラ基盤構築 | VPC, RDS, ECR設定完了 |
| **Week 2** | バックエンドデプロイ | ECS でAPI稼働、CI/CD構築 |
| **Week 3** | フロントエンド連携 | Vercel デプロイ、統合テスト |
| **Week 4** | 本番化・監視 | 監視設定、パフォーマンス調整 |

## 🚨 リスクと対策

### 高リスク
- **RDS接続問題**: セキュリティグループ、パラメータ設定を慎重に
- **CORS問題**: ALB・Vercel 間の通信設定を確認
- **コスト超過**: CloudWatch Budget でアラート設定

### 中リスク  
- **デプロイ失敗**: ロールバック手順を事前準備
- **パフォーマンス**: 負荷テストを実施
- **セキュリティ**: IAM 権限を最小限に

## 📚 事前学習・準備資料

### 必要なスキル・知識
1. **AWS基礎**: VPC, ECS, RDS, IAM
2. **Docker**: コンテナ化、マルチステージビルド
3. **GitHub Actions**: CI/CD パイプライン
4. **Vercel**: 静的サイトデプロイ

### 推奨学習リソース
- AWS ECS ハンズオン
- Docker ベストプラクティス
- GitHub Actions 公式ドキュメント
- Vercel デプロイガイド

---

この計画に基づいて、段階的にデプロイを進めることで、**安全で効率的な本番環境構築**が可能です。

**次のアクション**: どのPhaseから開始しますか？AWS アカウント設定から始めることをお勧めします。